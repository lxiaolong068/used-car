# äºŒæ‰‹è½¦è¾†ç®¡ç†ç³»ç»Ÿ

ä¸€ä¸ªåŸºäº Next.js 14 å¼€å‘çš„ç°ä»£åŒ–äºŒæ‰‹è½¦è¾†ç®¡ç†ç³»ç»Ÿï¼Œé‡‡ç”¨ Serverless æ¶æ„ï¼Œæ”¯æŒ Vercel ä¸€é”®éƒ¨ç½²ã€‚

## é¡¹ç›®æ¦‚è¿°

æœ¬ç³»ç»Ÿæ˜¯ä¸€ä¸ªå®Œæ•´çš„äºŒæ‰‹è½¦è¾†ç®¡ç†è§£å†³æ–¹æ¡ˆï¼Œæä¾›ä»è½¦è¾†ä¿¡æ¯ç®¡ç†åˆ°æˆæœ¬æ”¶ç›Šåˆ†æçš„å…¨å¥—åŠŸèƒ½ã€‚é‡‡ç”¨æœ€æ–°çš„ Next.js 14 æ¡†æ¶å¼€å‘ï¼Œå…·æœ‰é«˜æ€§èƒ½ã€å¯æ‰©å±•æ€§å¼ºçš„ç‰¹ç‚¹ã€‚

### åŠŸèƒ½ç‰¹æ€§

- ğŸš— **è½¦è¾†ç®¡ç†**
  - è½¦è¾†ä¿¡æ¯å½•å…¥ä¸ç®¡ç†
  - è½¦è¾†çŠ¶æ€è¿½è¸ª
  - è½¦è¾†å›¾ç‰‡ç®¡ç†
  - è½¦è¾†æ£€æŸ¥è®°å½•

- ğŸ’° **æˆæœ¬ç®¡ç†**
  - é‡‡è´­æˆæœ¬è®°å½•
  - ç»´ä¿®ä¿å…»è´¹ç”¨
  - å…¶ä»–æ”¯å‡ºç®¡ç†
  - æˆæœ¬åˆ†ææŠ¥è¡¨

- ğŸ“Š **æ”¶ç›Šç®¡ç†**
  - é”€å”®è®°å½•ç®¡ç†
  - åˆ©æ¶¦è®¡ç®—
  - æ”¶ç›Šè¶‹åŠ¿åˆ†æ
  - å¯¼å‡ºæŠ¥è¡¨

- ğŸ‘¥ **ç”¨æˆ·æƒé™ç®¡ç†**
  - å¤šè§’è‰²æƒé™æ§åˆ¶
  - æ“ä½œæ—¥å¿—è®°å½•
  - æ•°æ®è®¿é—®æ§åˆ¶
  - èœå•æƒé™çŠ¶æ€ç®¡ç†
  - æƒé™ç±»å‹åˆ†çº§æ§åˆ¶
  - èœå•æ™ºèƒ½æ’åº

## æŠ€æœ¯æ ˆ

- **è¿è¡Œç¯å¢ƒ**: Node.js (æ¨è v20.9.0 æˆ–æ›´é«˜ç‰ˆæœ¬)
- **å‰ç«¯æ¡†æ¶**: Next.js 14
- **ç¼–ç¨‹è¯­è¨€**: TypeScript
- **UI æ¡†æ¶**: Tailwind CSS
- **æ•°æ®åº“**: Prisma + MySQL
- **çŠ¶æ€ç®¡ç†**: SWR
- **è®¤è¯æ–¹æ¡ˆ**: JWT (jose)
- **éƒ¨ç½²å¹³å°**: Vercel

## ç³»ç»Ÿæ¶æ„

### å‰ç«¯æ¶æ„
```
app/
â”œâ”€â”€ components/        # ç»„ä»¶ç›®å½•
â”‚   â”œâ”€â”€ common/       # é€šç”¨ç»„ä»¶
â”‚   â””â”€â”€ ui/          # UI ç»„ä»¶
â”œâ”€â”€ contexts/         # å…¨å±€çŠ¶æ€
â”œâ”€â”€ hooks/           # è‡ªå®šä¹‰ Hooks
â””â”€â”€ lib/             # å·¥å…·å‡½æ•°
```

### åç«¯æ¶æ„
```
â”œâ”€â”€ api/             # API è·¯ç”±
â”œâ”€â”€ middleware/      # ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ cache.ts    # ç¼“å­˜ä¸­é—´ä»¶
â”‚   â”œâ”€â”€ rateLimit.ts # é™æµä¸­é—´ä»¶
â”‚   â””â”€â”€ auth.ts     # è®¤è¯ä¸­é—´ä»¶
â””â”€â”€ prisma/         # æ•°æ®åº“æ¨¡å‹
```

## éƒ¨ç½²æŒ‡å—

### Vercel éƒ¨ç½²ï¼ˆæ¨èï¼‰

1. **å‡†å¤‡å·¥ä½œ**
   - æ³¨å†Œ [Vercel è´¦å·](https://vercel.com)
   - å‡†å¤‡å¥½ MySQL æ•°æ®åº“ï¼ˆæ¨èä½¿ç”¨ PlanetScaleï¼‰
   - Fork æœ¬é¡¹ç›®åˆ°ä½ çš„ GitHub è´¦å·

2. **é…ç½®ç¯å¢ƒå˜é‡**
   åœ¨ Vercel é¡¹ç›®è®¾ç½®ä¸­æ·»åŠ ä»¥ä¸‹ç¯å¢ƒå˜é‡ï¼š
   ```
   DATABASE_URL=your_mysql_connection_string
   JWT_SECRET=your_jwt_secret
   NEXTAUTH_URL=https://your-domain.vercel.app
   NEXTAUTH_SECRET=your_nextauth_secret
   NODE_ENV=production
   PRISMA_GENERATE_DATAPROXY=true
   ```

3. **ä¸€é”®éƒ¨ç½²**
   [![Deploy with Vercel](https://vercel.com/button)](https://vercel.com/new/clone?repository-url=https://github.com/yourusername/used-car)

4. **æ•°æ®åº“è¿ç§»**
   ```bash
   # æœ¬åœ°æ‰§è¡Œæ•°æ®åº“è¿ç§»
   npm run prisma:generate
   npm run prisma:push
   ```

5. **éªŒè¯éƒ¨ç½²**
   - è®¿é—®ä½ çš„ Vercel åŸŸå
   - æ£€æŸ¥æ‰€æœ‰åŠŸèƒ½æ˜¯å¦æ­£å¸¸
   - æŸ¥çœ‹ç¯å¢ƒå˜é‡æ˜¯å¦ç”Ÿæ•ˆ

### å¸¸è§éƒ¨ç½²é—®é¢˜è§£å†³

1. **Node.js ç‰ˆæœ¬é—®é¢˜**
   å¦‚æœçœ‹åˆ° "Unsupported engine" è­¦å‘Šï¼Œè¯·ç¡®ä¿ï¼š
   - å‡çº§ Node.js åˆ° v20.9.0 æˆ–æ›´é«˜ç‰ˆæœ¬
   ```bash
   # Windows ä½¿ç”¨ nvm-windows å‡çº§ Node.js
   nvm install 20.9.0
   nvm use 20.9.0

   # Linux/Mac ä½¿ç”¨ nvm å‡çº§ Node.js
   nvm install 20.9.0
   nvm use 20.9.0
   ```
   - æˆ–è€…ä½¿ç”¨ `--force` å¼ºåˆ¶å®‰è£…ï¼ˆä¸æ¨èï¼‰
   ```bash
   npm install --force
   ```

2. **ä¾èµ–ç›¸å…³é”™è¯¯**
   å¦‚æœé‡åˆ° "Module not found" é”™è¯¯ï¼Œè¯·ç¡®ä¿è¿è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…æ‰€æœ‰å¿…è¦ä¾èµ–ï¼š
   ```bash
   # UI ç»„ä»¶ä¾èµ–
   npm install @headlessui/react@latest

   # è®¤è¯ç›¸å…³ä¾èµ–
   npm install jsonwebtoken
   npm install @types/jsonwebtoken --save-dev

   # æ•°æ®åº“ç›¸å…³ä¾èµ–
   npm install prisma@latest @prisma/client@latest

   # å¦‚æœè¿˜æœ‰å…¶ä»–ç¼ºå¤±ä¾èµ–ï¼Œè¯·æ ¹æ®é”™è¯¯æç¤ºå®‰è£…
   ```

   å¦‚æœåœ¨ Vercel éƒ¨ç½²æ—¶é‡åˆ°ä¾èµ–é—®é¢˜ï¼Œå¯ä»¥ï¼š
   1. åœ¨æœ¬åœ°å®‰è£…å®Œæ‰€æœ‰ä¾èµ–åï¼Œç¡®ä¿ package.json ä¸­å·²åŒ…å«æ‰€æœ‰å¿…è¦ä¾èµ–
   2. æäº¤æ›´æ–°åçš„ package.json å’Œ package-lock.json
   3. é‡æ–°éƒ¨ç½²é¡¹ç›®

3. **Prisma ç›¸å…³é—®é¢˜**
   - å¦‚æœçœ‹åˆ° Prisma ç‰ˆæœ¬æ›´æ–°æç¤ºï¼Œå¯ä»¥é€‰æ‹©æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼š
     ```bash
     npm install prisma@latest @prisma/client@latest
     ```
   - æˆ–è€…ä¿æŒå½“å‰ç‰ˆæœ¬ï¼Œå¿½ç•¥è­¦å‘Šï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰

4. **æ„å»ºå¤±è´¥é—®é¢˜**
   - ç¡®ä¿ package.json ä¸­çš„ scripts åŒ…å«ï¼š
     ```json
     {
       "scripts": {
         "vercel-build": "prisma generate && next build"
       }
     }
     ```
   - æ£€æŸ¥ vercel.json é…ç½®æ˜¯å¦æ­£ç¡®ï¼š
     ```json
     {
       "buildCommand": "npm run vercel-build",
       "env": {
         "PRISMA_GENERATE_DATAPROXY": "true",
         "NODE_ENV": "production"
       }
     }
     ```

5. **æ•°æ®åº“è¿æ¥é—®é¢˜**
   - ç¡®ä¿æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²æ ¼å¼æ­£ç¡®
   - æ£€æŸ¥æ•°æ®åº“æ˜¯å¦å…è®¸å¤–éƒ¨è¿æ¥
   - éªŒè¯ IP ç™½åå•è®¾ç½®

6. **æ€§èƒ½ä¼˜åŒ–å»ºè®®**
   - å¯ç”¨ Vercel Edge Functions
   - é…ç½®é€‚å½“çš„ç¼“å­˜ç­–ç•¥
   - ä½¿ç”¨ Vercel KV å­˜å‚¨

### æœ¬åœ°å¼€å‘ç¯å¢ƒæ­å»º

1. **å…‹éš†é¡¹ç›®**
   ```bash
   git clone https://github.com/yourusername/used-car.git
   cd used-car
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install

   # å®‰è£…å¿…è¦çš„é¢å¤–ä¾èµ–
   npm install @headlessui/react@latest
   npm install jsonwebtoken
   npm install @types/jsonwebtoken --save-dev

   # æ›´æ–° Prismaï¼ˆå¦‚æœéœ€è¦ï¼‰
   npm install prisma@latest @prisma/client@latest
   ```

3. **ç¯å¢ƒé…ç½®**
   ```bash
   cp .env.example .env
   # ç¼–è¾‘ .env æ–‡ä»¶ï¼Œé…ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡
   ```

4. **æ•°æ®åº“è®¾ç½®**
   ```bash
   npm run prisma:generate
   npm run prisma:push
   ```

5. **å¯åŠ¨å¼€å‘æœåŠ¡å™¨**
   ```bash
   npm run dev
   ```

## æ€§èƒ½ä¼˜åŒ–

### ç¼“å­˜ç­–ç•¥
- API å“åº”ç¼“å­˜ï¼ˆ5åˆ†é’Ÿï¼‰
- é™æ€èµ„æºç¼“å­˜ï¼ˆ7å¤©ï¼‰
- èœå•çŠ¶æ€ç¼“å­˜ï¼ˆ15åˆ†é’Ÿï¼‰

### Vercel ä¼˜åŒ–å»ºè®®
1. **ä½¿ç”¨ Vercel KV å­˜å‚¨**
   ```bash
   # å®‰è£… Vercel KV
   npm install @vercel/kv
   ```
   åœ¨ Vercel æ§åˆ¶å°å¯ç”¨ KV å­˜å‚¨

2. **é…ç½® Edge Functions**
   ```json
   // vercel.json
   {
     "functions": {
       "api/*.ts": {
         "memory": 1024,
         "maxDuration": 10
       }
     }
   }
   ```

3. **ä½¿ç”¨ Edge Middleware**
   - é€Ÿç‡é™åˆ¶
   - ç¼“å­˜æ§åˆ¶
   - å®‰å…¨å¤´éƒ¨

## ç›‘æ§ä¸ç»´æŠ¤

### æ€§èƒ½ç›‘æ§
- ä½¿ç”¨ Vercel Analytics
- è‡ªå®šä¹‰æ€§èƒ½æŒ‡æ ‡æ”¶é›†
- å“åº”æ—¶é—´ç›‘æ§

### é”™è¯¯å¤„ç†
- ç»Ÿä¸€çš„é”™è¯¯å“åº”æ ¼å¼
- è¯¦ç»†çš„é”™è¯¯æ—¥å¿—
- è‡ªåŠ¨å‘Šè­¦æœºåˆ¶

### å®‰å…¨æªæ–½
- è¯·æ±‚é€Ÿç‡é™åˆ¶
- JWT è®¤è¯
- SQL æ³¨å…¥é˜²æŠ¤
- XSS é˜²æŠ¤

## å¸¸è§é—®é¢˜

### éƒ¨ç½²ç›¸å…³
1. **æ•°æ®åº“è¿æ¥é—®é¢˜**
   - æ£€æŸ¥æ•°æ®åº“è¿æ¥å­—ç¬¦ä¸²
   - ç¡®ä¿æ•°æ®åº“å…è®¸å¤–éƒ¨è¿æ¥
   - éªŒè¯ IP ç™½åå•è®¾ç½®

2. **ç¯å¢ƒå˜é‡é—®é¢˜**
   - ç¡®ä¿æ‰€æœ‰å¿…è¦çš„ç¯å¢ƒå˜é‡éƒ½å·²è®¾ç½®
   - æ£€æŸ¥ç¯å¢ƒå˜é‡æ ¼å¼æ˜¯å¦æ­£ç¡®
   - é‡æ–°éƒ¨ç½²ä»¥åº”ç”¨æ–°çš„ç¯å¢ƒå˜é‡

3. **æ€§èƒ½é—®é¢˜**
   - æ£€æŸ¥æ•°æ®åº“æŸ¥è¯¢æ€§èƒ½
   - ç¡®è®¤ç¼“å­˜ç­–ç•¥æ˜¯å¦ç”Ÿæ•ˆ
   - æŸ¥çœ‹ Vercel éƒ¨ç½²æ—¥å¿—

4. **ç‰ˆæœ¬å…¼å®¹æ€§**
   - ç¡®ä¿æ‰€æœ‰ä¾èµ–çš„ç‰ˆæœ¬å…¼å®¹
   - æ£€æŸ¥æ˜¯å¦æœ‰ç‰ˆæœ¬ä¸å…¼å®¹çš„ä¾èµ–
   - å‡çº§æˆ–æ›¿æ¢ä¸å…¼å®¹çš„ä¾èµ–

## æ›´æ–°æ—¥å¿—

### v0.1.0 (2024-01-28)
- æƒé™ç®¡ç†åŠŸèƒ½å¢å¼º
  - æ–°å¢æƒé™çŠ¶æ€ç®¡ç†
  - æ–°å¢æƒé™ç±»å‹åˆ†çº§
  - æ–°å¢èœå•æ™ºèƒ½æ’åº
  - ä¼˜åŒ–èœå•æ˜¾ç¤ºé€»è¾‘
  - æå‡ç³»ç»Ÿå®‰å…¨æ€§

### v1.0.0 (2024-01-28)
- åˆå§‹ç‰ˆæœ¬å‘å¸ƒ
- åŸºç¡€åŠŸèƒ½å®ç°
- Vercel éƒ¨ç½²æ”¯æŒ

## è´¡çŒ®æŒ‡å—

1. Fork é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. æäº¤ Pull Request

## è®¸å¯è¯

ISC License

## è”ç³»æ–¹å¼

- é¡¹ç›®ç»´æŠ¤è€…ï¼š[Your Name]
- Emailï¼š[your.email@example.com]
- GitHubï¼š[your-github-username]
 
