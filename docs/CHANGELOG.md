# 更新日志

## [0.1.0] - 2024-01-28

### 权限管理功能增强

#### 新增功能
- 添加权限状态管理（启用/禁用）功能
- 添加权限排序功能
- 实现权限类型区分（菜单/按钮/API）

#### 功能优化
- 左侧导航栏现在只显示启用状态的菜单
- 菜单按照 sort_order 字段排序显示
- "权限管理"菜单设置为必要功能，禁止禁用

#### 技术改进
- 优化菜单查询 SQL，使用 JOIN 查询提升性能
- 修复 BigInt 序列化问题
- 完善类型定义，增强代码健壮性
- 使用原始 SQL 查询替代 Prisma 查询，解决复杂查询的类型问题

#### 数据库变更
- permission 表新增字段：
  - status: Int (默认值: 1，1=启用，0=禁用)
  - permission_type: String (默认值: 'menu'，可选值: 'menu'/'button'/'api')
  - sort_order: Int (默认值: 0，用于菜单排序)

#### API 变更
- GET /api/permissions/menus
  - 新增过滤条件：status = 1
  - 新增过滤条件：permission_type = 'menu'
  - 新增排序：按 sort_order 升序排列
- PUT /api/permissions/[id]
  - 新增字段：status
  - 新增字段：permission_type
  - 新增字段：sort_order

#### 前端变更
- 权限编辑表单新增字段：
  - 状态选择器（启用/禁用）
  - 权限类型选择器（菜单/按钮/API）
  - 排序输入框
- 权限管理菜单禁用状态选择器
- 添加操作成功/失败的 Toast 提示

#### 安全性改进
- 防止禁用关键系统菜单（如：权限管理）
- 添加用户登录状态验证

#### 已知问题
- 暂无

#### 后续计划
- [ ] 添加权限批量导入/导出功能
- [ ] 添加权限变更日志记录
- [ ] 优化权限树形结构的展示
- [ ] 添加权限克隆功能 